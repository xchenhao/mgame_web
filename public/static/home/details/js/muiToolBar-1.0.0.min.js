!function (t) {
    t.fn.hoverDelay = function (e) {
        var a, i = {hoverDuring: 200, outDuring: 200, hoverEvent: t.noop, outEvent: t.noop};
        return a = t.extend(i, e || {}), t(this).each(function () {
            var e = this;
            t(this).hover(function () {
                clearTimeout(e.outTimer), e.hoverTimer = setTimeout(function () {
                    a.hoverEvent.call(e)
                }, a.hoverDuring)
            }, function () {
                clearTimeout(e.hoverTimer), e.outTimer = setTimeout(function () {
                    a.outEvent.call(e)
                }, a.outDuring)
            })
        })
    }
}(jQuery), $(function () {
    function t(t) {
        $(window).scroll(function () {
            var e = $(this).scrollTop();
            e >= 200 ? t.show() : t.hide()
        }), t.on("click", function () {
            return $("html, body").animate({scrollTop: 0}, 300), !1
        })
    }

    var e = window.Auth && Auth.getAuthInfo() || null, a = {
        init: function () {
            this.load_style("http://s2.hqbcdn.com/", "assets/v4/css/muiToolBar-1.0.0.css"), this.renderDom(), this.render_loginInPannel(function () {
                a.event_sign_handle(), a.event_tempt_newuser()
            }), this.eventTrigger(), this.render_cartCount(), this.time_clock()
        }, load_style: function (t, e) {
            try {
                var a, i = document.getElementsByTagName("head").item(0);
                a = document.createElement("link"), a.setAttribute("rel", "stylesheet"), a.setAttribute("type", "text/css"), a.setAttribute("href", t + e), i.appendChild(a)
            } catch (n) {
            }
        }, renderDom: function () {
            var t = '<div id="mui_bar"><div class="mui_bar_con"><div class="newuser"><a class="newuserRemindIcon" href="http://stopic.okhqb.com/xinren2016.html?utml=xrcelan" target="_blank"></a><a class="temptToRegister" href="http://stopic.okhqb.com/xinren.html?utml=xrcelan" target="_blank">新人专享</a></div><div class="userArea"><div class="login_in_pannel hide"></div><div class="login_up_pannel"><a class="login_up_i"></a></div></div><div class="miniCart"><a class="cart" href="javascript:;"><i class="cart_icon"></i>购物车<em class="cart_num">0</em></a></div><div class="kfPannel"><a id="kfNewPannel" href="javascript:;"></a><div class="nav-contact-kfNew">联系客服</div></div><div class="scrollTop"><a href="javascript:;" title="返回顶部"></a></div></div><div class="cart_con_box"><h2>购物车<i class="nav_car_times" data-times="0"></i><i class="nav_car_close"></i></h2> <div class="cart_con"><div class="cart_tips">您的购物车是空的<br>如您已添加商品，请<a target="_blank" href="http://login.okhqb.com/member/login.html">登录</a>查看</div></div></div></div>';
            $("body").append(t)
        }, render_loginInPannel: function (t) {
            var a = $(".userArea"), i = $(".login_in_pannel", a), n = $(".login_up_pannel", a), o = "";
            e && 1 === e.logined && 1 === e.member_type ? (o = '<span class="login_in_i"><a href="http://my.okhqb.com/my/home.html?ad=dd_id"><img width="30" height="30" src="' + e.avatar + '" alt="用户头像" class="user_avatar" /></a></span><div class="login_in hide"><a href="http://www.okhqb.com/member/logout.html" class="login_out">[退出]</a><span class="u_head"><img width="80" height="80" src="' + e.avatar + '" alt="用户头像"><a class="u_mask" href="http://my.okhqb.com/my/home.html?ad=dd_id"></a></span><div class="u_info"><p class="u_name"><a href="http://my.okhqb.com/my/home.html?ad=dd_id" target="_blank">Hi, ' + e.nickname + '</a></p><p class="u_coin">小强币：<b>' + (e.total_points || 0) + "</b>个</p></div></div>", i.empty().append(o).show(), n.hide()) : (n.find(".login_up").length || (o = '<div class="login_up hide"><form action=""><div class="f_item"><label for="userName" class="f_label">用户名：</label><input type="text" id="userName" name="userName" class="f_input" maxlength="50" value=""></div><div class="f_item"><label for="passWord" class="f_label">密码：</label><input type="password" id="passWord" name="passWord" class="f_input" value=""></div><p class="f_tips"></p><a href="javascript:;" class="sub_btn">登录</a><p class="forgetpwd"><a target="_blank" href="http://login.okhqb.com/member/memberForget.html">忘记密码？</a></p></form></div>', n.append(o)), n.show(), i.hide()), t && "function" == typeof t && t.apply(a)
        }, render_toolbar: function (t) {
            var e = $("#toolbar_bg") || $("#toolbar"), t = t || "强粉";
            try {
                e.find(".notloggedin").hide(), e.find(".thelogged").html('您好，<a class="u_name" rel="nofollow" href="' + _href + '">' + t + '</a>&nbsp;&nbsp;欢迎回来&nbsp;&nbsp;<a href="http://www.okhqb.com/member/logout.html" class="logout">&nbsp;退出</a><a href="http://my.okhqb.com/my/home.html?ad=dd_id" class="signEveryday"><span>签到赚小强币</span></a>').show()
            } catch (a) {
            }
        }, event_tempt_newuser: function () {
            $("#mui_bar").find(".newuser"), $("#mui_bar").find(".temptToRegister")
        }, event_sign_handle: function () {
            var t = $(".userArea"), i = $(".login_in_pannel", t), n = $(".login_up_pannel", t),
                o = ($(".login_in_i", t), $(".login_up_i", t), $("#userName", n)), s = $("#passWord", n),
                l = $(".f_tips", n), r = $(".sub_btn", t);
            i.hoverDelay({
                hoverEvent: function (t) {
                    i.find(".login_in").show()
                }, outEvent: function (t) {
                    i.find(".login_in").hide()
                }, hoverDuring: 300
            }), n.hoverDelay({
                hoverEvent: function () {
                    n.find(".login_up").show()
                }, outEvent: function () {
                    n.find(".login_up").hide()
                }, hoverDuring: 300
            }), o.add(s).on("focus", function () {
                l.removeClass("f_tip_error").html("").hide()
            }).keypress(function (t) {
                13 === t.which && r.trigger("click")
            }), r.on("click", function () {
                var t = $.trim(o.val()), i = $.trim(s.val());
                if (t.length < 1)return l.addClass("f_tip_error").html("请输入您的用户名！").show(), !1;
                if (i.length < 1) l.addClass("f_tip_error").html("请输入您的密码！").show(); else try {
                    $.ajax({
                        url: "http://login.okhqb.com/member/boxLogin.json",
                        data: {userName: t, passWord: i},
                        type: "POST",
                        dataType: "jsonp",
                        jsonpCallback: "signInCallback",
                        beforeSend: function () {
                            l.addClass("f_tip_error").html("正在为您努力登录...").show()
                        },
                        success: function (t) {
                            200 == t.code ? (e = $.parseJSON(t.data), a.render_loginInPannel(), a.render_toolbar(e.nickname), l.removeClass("f_tip_error").html("").hide(), window.location.href = window.location.href) : l.addClass("f_tip_error").html(t.msg)
                        }
                    })
                } catch (n) {
                    l.addClass("f_tip_error").html("登录失败：系统异常").show()
                }
                return !1
            })
        }, render_cartCount: function () {
            $.ajax({
                type: "GET",
                url: "http://buy.okhqb.com/cart/getCartsForToolbar.json",
                dataType: "jsonp",
                jsonp: "callback",
                success: function (t) {
                    if (200 == t.code)if ($(".cart_num").html(t.data.count), t.data.items) {
                        var a = t.data, i = a.items,
                            n = 3600 - (parseInt(.001 * a.currentTime) - parseInt(.001 * a.countDownTime)), o = "";
                        o = n > 0 ? '<h2>购物车<i class="nav_car_times" data-times="' + n + '">库存有限，保留0分0秒</i><i class="nav_car_close"></i></h2><div class="cart_con"><div class="cart_list_box" id="cart_list_box"><ul class="cart_list">' : '<h2>购物车<i class="nav_car_times" data-times="' + n + '">已超时，请尽快结算</i><i class="nav_car_close"></i></h2><div class="cart_con"><div class="cart_list_box" id="cart_list_box"><ul class="cart_list">';
                        for (var s = 0; s < i.length; s++)o += '<li class="' + i[s].skuId + '"><a title="' + i[s].goodsTitle + '" target="_blank" href="http://www.okhqb.com/item/' + i[s].skuId + '.html" class="goods_pic"><img height="60" alt="' + i[s].goodsTitle + '" src="' + i[s].imageMD5 + '" widht="60"></a>', o += '<div class="goods_info">', o += '<a target="_blank" title="' + i[s].goodsTitle + '" href="http://www.okhqb.com/item/' + i[s].skuId + '.html" class="goods_tit">' + i[s].goodsTitle + "</a>", o += '<div class="goods_num"><i class="price">&yen;' + (i[s].promotePrice || i[s].price) + '</i>×<i class="num">' + i[s].quantity + "</i></div></div></li>";
                        o += "</ul></div>", o += '<div class="car_list_total"><span>', o += '<b class="car_total_price">&yen;<i class="car_total_price_i">' + a.totalFee + "</i></b><br/>", o += '<b class="car_total_num">共<i class="car_con_num">' + a.count + "</i>件商品</b></span>", o += '<a href="http://buy.okhqb.com/buy/cart.html" target="_blank">去购物车结算</a></div>', $(".cart_con_box").html(o), i.length >= 6 && ($(".cart_list_box").height(600), $(".car_list_total").css({
                            position: "fixed",
                            bottom: 0,
                            width: 250
                        }), $("#cart_list_box").perfectScrollbar({suppressScrollX: !0})), window.NAV_RIGHT_TIMER && window.NAV_RIGHT_TIMER.init()
                    } else e && 1 === e.logined && 1 === e.member_type ? $(".cart_con_box").html('<img width="203" height="184" src="http://s2.hqbcdn.com/assets/v4/images/process/nav_null.jpg" />') : $(".cart_con").html('<div class="cart_tips">您的购物车是空的<br>如您已添加商品，请<a target="_blank" href="http://login.okhqb.com/member/login.html">登录</a>查看</div>')
                }
            })
        }, time_clock: function () {
            var t = {};
            t.init = function () {
                t.clockObj = $(".nav_car_times"), t.times = $(".nav_car_times") ? $(".nav_car_times").attr("data-times") : 0, t.times > 0 && (clearInterval(t.clock), t.clock = setInterval(function () {
                    if (t.times <= 0)return clearInterval(t.clock), t.clockObj.html("已超时，立即结算还有库存商品"), !1;
                    t.times--;
                    var e = parseInt(t.times / 60), a = parseInt(t.times % 60);
                    e = e >= 10 ? e : "0" + e, a = a >= 10 ? a : "0" + a, t.clockObj.html("库存有限，保留" + e + "分" + a + "秒")
                }, 1e3))
            }, window.NAV_RIGHT_TIMER = t, t.init()
        }, event_cart_handle: function () {
            var t = $("#mui_bar .miniCart"), e = $(".cart_con_box"), a = ($(".cart_tips", e), $(".cart_list", e)),
                i = $(".mini_total", e), n = ($(".cart_info", e), this);
            a.hide(), i.hide(), t.on("click", function () {
                e.show(), n.render_cartCount()
            })
        }, event_scrollTop_handle: function () {
            var e = $("#mui_bar .scrollTop"), a = $(window).height();
            728 > a && $(".scrollTop").css("bottom", "30px"), t(e)
        }, event_kf_handle: function () {
            try {
                $("#kfNewPannel,.kfPannel, .service").click(function () {
                    window.open("http://im.okhqb.com/client", "OKHQBIM", "width=340,height=" + window.screen.height + "，menubar=no,location=no,status=no,toolbar=no,left=0,top=0")
                })
            } catch (t) {
                $("#kfNewPannel,.kfPannel").click(function () {
                    return art.dialog({
                        id: "__IM",
                        title: "系统提示",
                        content: '客服系统不存在，请联系客服电话<b style="color:red">400-999-1258</b>！'
                    }), !1
                })
            }
        }, evevt_carlist_handle: function () {
            var t = $(".cart_con_box");
            $(".nav_car_time");
            $(document).click(function (e) {
                $(e.target).hasClass("cart") || t.hide()
            }), $(".nav_car_close").live("click", function () {
                t.hide()
            })
        }, eventTrigger: function () {
            this.event_cart_handle(), this.event_kf_handle(), this.evevt_carlist_handle(), this.event_scrollTop_handle()
        }
    };
    a.init()
});